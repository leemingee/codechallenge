webpackJsonp([4],{161:function(i,exports,e){i.exports=e(5)(10)},162:function(i,exports,e){"use strict";function t(i){if(i&&i.__esModule)return i;var e={};if(null!=i)for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function s(i){return i&&i.__esModule?i:{default:i}}Object.defineProperty(exports,"__esModule",{value:!0});var o=s(e(101)),d=s(e(3)),a=t(e(1)),l=s(e(0)),n=s(e(51)),r=s(e(161)),h=s(e(4)),u=t(e(6)),p=s(e(192)),c=r.default.View.extend({className:"js-video-player",tagName:"div",events:{"click .js-video-player__still":"playVideo",mouseenter:"playPreview",mouseleave:"stopPreview"},initialize:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.cacheSelectors(),this.videoId=this.$el.data("video-id"),this.wrapperIdPrefix=this.$el.data("wrapper-id-prefix"),this.uniqueId=this.$el.data("unique-id"),this.aspectRatio=this.$el.data("aspect-ratio"),this.flags=this.$el.data("flags"),this.vidSlot=this.$el.data("video-slot"),this.adSlotSize=this.$el.data("ad-slot-size"),this.width=i.width,this.autoplay=this.$el.data("autoplay"),this.mute=this.$el.data("muted"),this.link=this.$el.data("link"),this.isCarouselPlaceholder=this.$el.hasClass("js-video-player--placeholder"),this.autoPlayWhenVisible=this.$el.hasClass("js-video-player--autoplay-when-visible"),this.isSticky=this.$el.hasClass("js-video-player--is-sticky"),this.shouldTargetPreroll=i.shouldTargetPreroll,1==this.autoplay?this.mute=!0:"boolean"!=typeof this.mute&&(this.mute=!1),this.suppressVideo=this.$el.data("suppress-video"),this.$previewVideo.on("ended",a.bind(function(){this.$el.removeClass("is-playing-preview")},this)),"suppressed"!==this.suppressVideo){if(this.buildModel(),this.autoPlayWhenVisible&&this.setupIO(),this.handleVPAID(),this.model.get("disableVid")){var e=(0,l.default)("#video-player-error").html(),t=this.$el.find(".js-video-player__error"),s=this.width;"thrillist"===Contra.Settings.company?t.addClass("active"):(t.parent().addClass("no-360"),s=(s=parseInt(.75*s,10))<240?240:s),t.css({"max-width":s+"px"}),t.html(n.default.render(e))}if(this.context=this.$el.data("context"),this.position=this.$el.data("position"),this.listenTo(this.model,"Video:playing",this.onVideoPlaying),this.listenTo(this.model,"Video:completed",this.onVideoCompleted),this.listenTo(this.model,"Video:paused",this.onVideoPaused),this.listenTo(this.model,"Video:muted",this.onVideoMuted),this.listenTo(this.model,"Video:unmuted",this.onVideoUnmuted),this.listenTo(this.model,"Video:fullscreened",this.onVideoFullscreened),this.listenTo(this.model,"Video:minimized",this.onVideoMinimized),this.listenTo(this.model,"Video:position",this.onVideoPosition),this.listenTo(this.model,"Video:adPlaying",this.onVideoPlaying),this.listenTo(this.model,"Video:adError",this.onVideoAdError),this.listenTo(this.model,"Video:playing",this.onInitialPlay),this.isCarouselPlaceholder){var o=this;h.default.subscribe("videoCarousel/removePlaceholder",function(){o.remove()})}h.default.subscribe("article/readMore",a.bind(this.buildModel,this))}},cacheSelectors:function(){this.$previewVideo=this.$(".js-video-player__preview")},buildModel:function(){(!this.width||this.width<=1)&&(this.width=this.$el.width()),!this.model&&this.width>1&&(this.model=new p.default({video_id:this.videoId,unique_id:this.uniqueId,wrapper_id_prefix:this.wrapperIdPrefix,aspect_ratio:this.aspectRatio,width:this.width,flags:this.flags,autoplay:this.autoplay,mute:this.mute,link:this.link,autoPlayWhenVisible:this.autoPlayWhenVisible,isSticky:this.isSticky,shouldTargetPreroll:this.shouldTargetPreroll,vidSlot:this.vidSlot,adSlotSize:this.adSlotSize}))},handleVPAID:function(){var i=this;this.model.player.on("adStarted",function(){var t=i;e.e(20).then(e.bind(null,256)).then(function(i){new i.default({player:t.model.player}).init()})})},setupIO:function(){var i=this;this.vidWrap=this.el.querySelector(".video-player__video"),this.closeBtn=this.vidWrap.querySelector(".video-player__close-btn"),this.stickyClass="video-player--sticky",this.firstViewClass="video-player--initial-view",this.observer=new IntersectionObserver(this.toggleSticky.bind(this),{threshold:[0,.1,.9,1]}),this.observer.observe(this.vidWrap.parentElement),this.isSticky&&this.closeBtn.addEventListener("click",function(e){e.preventDefault(),i.observer.disconnect(),i.vidWrap.classList.remove(i.stickyClass),i.model.pause(),setTimeout(function(){i.model.resize(i.vidWrap)},0)})},toggleSticky:function(i,e){var t=this,s=i.slice(-1)[0],o=s.boundingClientRect.top,d=s.boundingClientRect.bottom,a=window.innerHeight/2,l=this.vidWrap.classList;if(!l.contains(this.firstViewClass)&&(s.intersectionRatio>.1||d-window.innerHeight<0))return l.add(this.firstViewClass),this.playVideo(),this.vidWrap.parentElement.style.height=this.vidWrap.clientHeight+"px",void(this.isSticky||e.disconnect());var n=l.contains(this.stickyClass);o<a?l.toggle(this.stickyClass,o<0):d>a&&(s.intersectionRatio>.9?l.remove(this.stickyClass):l.contains(this.firstViewClass)&&l.add(this.stickyClass)),n!==l.contains(this.stickyClass)&&setTimeout(function(){t.model.resize(t.vidWrap)},0)},showCloseBtn:function(){this.closeBtn.classList.remove("hidden")},stickyGA:function(i){var e=this.vidWrap.classList.contains(this.stickyClass)?"minified":"inline";u.push(this.context,"elapsed "+i+" seconds","view:"+e)},playPreview:function(){this.canControlPreview()&&(this.$el.addClass("is-playing-preview"),this.$previewVideo.get(0).play())},stopPreview:function(){this.canControlPreview()&&(this.$el.removeClass("is-playing-preview"),this.$previewVideo.get(0).pause())},canControlPreview:function(){var i=this.$previewVideo.length;if(i&&!this.$previewVideo.attr("src")){var e=this.$previewVideo.data("src");this.$previewVideo.get(0).setAttribute("src",e)}return i&&(!this.model||!this.model.get("playing"))},playVideo:function(){"suppressed"!==this.suppressVideo&&(this.$el.hasClass("no-360")?this.$el.addClass("no-360--clicked").find(".js-video-player__error").addClass("active").end().find(".video-player__icon").hide():(this.removeStillImage(),this.model.play()),this.addCredit())},removeStillImage:function(){this.$el.removeClass("is-not-playing")},onVideoPlaying:function(i){this.removeStillImage(),this.stopPreview(i);var e="buffered_";if(i.initialPlay?e="playing_":i.wasPaused&&(e="resumed_"),this.addCredit(),this.autoPlayWhenVisible&&"object"===(0,o.default)(this.vidWrap)){setTimeout(this.showCloseBtn.bind(this),5e3);var t=this.vidWrap.classList,s="js-video-player--autoplayinview-tracked";if(t.contains(s))return;this.stickyGA(0),setTimeout(this.stickyGA.bind(this,3),3e3),setTimeout(this.stickyGA.bind(this,6),6e3),t.add(s)}u.push(this.context,e+i.videoId,this.position)},onVideoAdError:function(i){var e=d.default.device.portable?"mobile":"desktop";u.push(this.context,"ad error: "+i.message,e+" | tag:"+i.tag)},onVideoCompleted:function(i){var e=this;if(this.removeCredit(),u.push(this.context,"completed_"+i.videoId,this.position),this.isCarouselPlaceholder&&(this.remove(),h.default.publish("videoCarousel/playFirstVideo")),this.isSticky){this.observer.disconnect();var t=this.vidWrap.classList;t.contains(this.stickyClass)&&(t.remove(this.stickyClass),setTimeout(function(){e.model.resize(e.vidWrap)},0))}},onVideoPaused:function(i){this.removeCredit(),u.push(this.context,"paused_"+i.videoId,this.position)},removeCredit:function(){this.$el.parent().hasClass("js-swap-credit")&&this.$el.closest("figure").removeClass("toggle-credit")},addCredit:function(){this.$el.parent().hasClass("js-swap-credit")&&this.$el.closest("figure").addClass("toggle-credit")},onVideoMuted:function(i){u.push(this.context,"muted_"+i.videoId,this.position)},onVideoUnmuted:function(i){u.push(this.context,"unmuted_"+i.videoId,this.position)},onVideoFullscreened:function(i){u.push(this.context,"fullscreened_"+i.videoId,this.position)},onVideoMinimized:function(i){u.push(this.context,"minimized_"+i.videoId,this.position)},onVideoPosition:function(i){u.push(this.context,"percent_complete_"+i.videoId+"_"+i.videoDuration,i.percentageComplete)}});exports.default=c},192:function(i,exports,e){"use strict";function t(i){return i&&i.__esModule?i:{default:i}}Object.defineProperty(exports,"__esModule",{value:!0});var s=t(e(161)),o=t(e(3)),d=t(e(4)),a=function(i){if(i&&i.__esModule)return i;var e={};if(null!=i)for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}(e(57)),l=s.default.Model.extend({defaults:{video_id:"",unique_id:"",wrapper_id_prefix:"video",aspect_ratio:"16:9",width:0,ready:!1,playing:!1,paused:!1,stopped:!1,completed:!1,percent_viewed:0,autostart:!1,mute:!1,autoPlayWhenVisible:!1,isSticky:!1,shouldTargetPreroll:null},jwPlayer:window.jwplayer||function(){},initialPlay:!0,initialize:function(i){var e=this.get("video_id"),t=this.get("unique_id"),s=this.get("wrapper_id_prefix"),l=".mp4",n=this.get("width"),r=this.get("aspect_ratio"),h=o.default.device.portable,u=this.get("autoplay"),p="boolean"==typeof this.get("mute")?this.get("mute"):u,c=Contra.Settings.JWPlayer.feed_id_360||"",v=this.get("link"),y=this.get("vidSlot"),g="string"==typeof this.get("adSlotSize")&&""!==this.get("adSlotSize")?this.get("adSlotSize"):"640x480",f={},m=i.flags&&i.flags.indexOf("360-video")>-1;this.set("is360Video",m),r=r.replace("-",":"),(n<Contra.Settings.JWPlayer.min_resolution||!h||m)&&(n=Contra.Settings.JWPlayer.max_resolution),n&&(l="-"+n+l);var w=Contra.Settings.JWPlayer.video_endpoint+e+l;h&&m&&this.jwPlayer.utils.isIOS()&&"kGIrdNwK"===e&&(w=window.location.origin+"/jw-videos/"+e+"-640.mp4"),this.player=this.jwPlayer(s+t);var V=!1;if(m&&(o.default.device.ios||this.player.utils.isSafari())&&(u=!1,V=!0),this.set("disableVid",V),!V){var _={position:"pre",videotype:y,adSlotSize:g},P={playlist:this.buildPlaylist(m,c,e,w),aspectratio:r,primary:"html5",preload:"none",plugins:f,stretching:"",autostart:u,mute:p,sharing:{link:v,sites:["facebook","twitter","pinterest","email"]},advertising:{client:"googima",admessage:"Your video will play in xx seconds",autoplayadsmuted:!0,enablepreloading:!0,vpaidcontrols:!0,schedule:{adbreak1:{offset:"pre",tag:a.getVideoAdTag(_)}}}},b=this.get("shouldTargetPreroll");"function"!=typeof b||b(this)||delete P.advertising.schedule.adbreak1,this.player.setup(P),this.bindPlayerEvents();var C=this;d.default.subscribe("video/stopAll",function(i,e){!0===C.attributes.playing&&e.attributes.video_id!==C.attributes.video_id&&C.player.pause()})}},play:function(){this.player.play("playing")},pause:function(){this.player.pause("paused")},stop:function(){this.player.stop()},setMute:function(){var i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.player.setMute(i)},resize:function(i,e,t){e="number"!=typeof e?i.clientWidth:e,t="number"!=typeof t?i.clientHeight:t,this.player.resize(e,t)},bindPlayerEvents:function(){this.player.on("ready",this.onReady,this),this.player.on("play",this.onPlaying,this),this.player.on("pause",this.onPaused,this),this.player.on("idle",this.onStopped,this),this.player.on("complete",this.onCompleted,this),this.player.on("mute",this.onMuteToggle,this),this.player.on("fullscreen",this.onFullscreenToggle,this),this.player.on("time",this.onPlayedPosition,this),this.player.on("adPlay",this.onAdPlaying,this),this.player.on("adError",this.onAdError,this)},buildPlaylist:function(i,e,t,s){var o={currentQuality:1,mediaid:t,file:s};return i&&(o.stereomode="monoscopic"),e&&(o.recommendations=Contra.Settings.JWPlayer.manifest_endpoint+""+e+"?related_media_id="+t),[o]},onReady:function(){this.set("ready",!0),d.default.publish("video/ready",this),this.trigger("Video:ready",{videoId:this.get("video_id")})},onAdPlaying:function(){d.default.publish("video/adplay",this),this.trigger("Video:adPlaying",{videoId:this.get("video_id")})},onAdError:function(i){d.default.publish("video/aderror",this),this.trigger("Video:adError",{videoId:this.get("video_id"),message:i.message,tag:i.tag})},onPlaying:function(i){d.default.publish("video/stopAll",this),this.set({playing:!0,paused:!1,stopped:!1,completed:!1}),this.trigger("Video:playing",{videoId:this.get("video_id"),initialPlay:this.initialPlay,wasPaused:"paused"===i.oldstate}),this.initialPlay=!1},onPaused:function(){this.set({playing:!1,paused:!0,stopped:!1}),this.trigger("Video:paused",{videoId:this.get("video_id")})},onStopped:function(){this.set({playing:!1,paused:!1,stopped:!0}),this.trigger("Video:stopped",{videoId:this.get("video_id")})},onCompleted:function(){this.set({playing:!1,paused:!1,stopped:!1,completed:!0}),this.trigger("Video:completed",{videoId:this.get("video_id")}),this.initialPlay=!0},onMuteToggle:function(i){var e="Video:unmuted";i.mute&&(e="Video:muted"),this.trigger(e,{videoId:this.get("video_id")})},onFullscreenToggle:function(i){var e="Video:minimized";i.fullscreen&&(e="Video:fullscreened",this.get("autoPlayWhenVisible")&&this.player.getMute()&&(this.player.setMute(!1),this.player.setVolume(20))),this.trigger(e,{videoId:this.get("video_id")})},onPlayedPosition:function(i){var e=Math.round(i.position/i.duration*100);this.defaults.percent_viewed!==e&&(this.defaults.percent_viewed=e,this.trigger("Video:position",{videoId:this.get("video_id"),percentageComplete:Math.round(e),videoDuration:i.duration}))}});exports.default=l}});